/*
 * @(#)pres_waitset.h    generated by: makeheader    Mon Dec  3 23:08:15 2007
 *
 *		built from:	waitset.ifc
 */

#ifndef pres_waitset_h
#define pres_waitset_h


 #ifndef pres_dll_h
    #include "pres/pres_dll.h"
 #endif
 #ifndef osapi_type_h
    #include "osapi/osapi_type.h"
 #endif
 #ifndef osapi_ntptime_h
    #include "osapi/osapi_ntptime.h"
 #endif
 #ifndef reda_sequenceNumber_h
    #include "reda/reda_sequenceNumber.h"
 #endif
 #ifndef pres_common_h
    #include "pres/pres_common.h"
 #endif

#ifdef __cplusplus
    extern "C" {
#endif


struct PRESCondition;

struct ConditionNode {
    struct REDAInlineListNode _node;
    struct PRESCondition *_presConditionPtr;
    RTIBool isActive;
    RTIBool wasActive; 
};

struct PRESWaitSetIterator {
    struct ConditionNode* _conditionNode;
};

struct PRESWaitSet {
    struct RTIOsapiSemaphore* _bSem;
    struct REDAInlineList _conditionList;
    unsigned int _activeConditionsCount;
    unsigned int _snapShotActiveConditionsCount;
    RTIBool _waitSetTaken;
    RTIBool _isActive;
    struct REDAExclusiveArea* _ea;
    struct PRESWaitSetIterator iter;
};

extern PRESDllExport
struct PRESWaitSet* PRESWaitSet_new(struct REDAExclusiveArea* ea,
                                    struct REDAWorker* worker);

extern PRESDllExport
RTIBool PRESWaitSet_delete(struct PRESWaitSet *self, struct REDAWorker* worker);

extern PRESDllExport
int PRESWaitSet_wait(struct PRESWaitSet *self,
           struct RTINtpTime* timeout, struct REDAWorker* worker);

extern PRESDllExport
int PRESWaitSet_attach_condition(struct PRESWaitSet *self,
           struct PRESCondition* condition, struct REDAWorker* worker);

extern PRESDllExport
int PRESWaitSet_detach_condition(struct PRESWaitSet *self,
           struct PRESCondition* condition, struct REDAWorker* worker);

extern PRESDllExport
int PRESWaitSet_start_conditions_iterator(struct PRESWaitSet *self,
                                          RTIBool activeCondition,
                                          struct REDAWorker* worker);

extern PRESDllExport
void PRESWaitSet_end_conditions_iterator(struct PRESWaitSet *self,
                                         struct REDAWorker* worker);

extern PRESDllExport
struct PRESWord* PRESWaitSet_get_next_condition(struct PRESWaitSet *self,
                                                RTIBool activeCondition,
                                                struct REDAWorker* worker);

extern PRESDllExport
void  PRESWaitSet_end_wait(struct PRESWaitSet *self, 
                                  struct REDAWorker* worker);


#ifdef __cplusplus
    }	/* extern "C" */
#endif

#endif /* pres_waitset_h */
